<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>POC on Byebyedoggy</title>
        <link>https://byebydoggy.github.io/categories/poc/</link>
        <description>Recent content in POC on Byebyedoggy</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Mon, 29 Dec 2025 12:11:01 +0800</lastBuildDate><atom:link href="https://byebydoggy.github.io/categories/poc/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>1229 PHPEMS Coupon Recharge Race Condition Poc</title>
        <link>https://byebydoggy.github.io/post/2025/1229-phpems-coupon-recharge-race-condition-poc/</link>
        <pubDate>Mon, 29 Dec 2025 12:11:01 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/1229-phpems-coupon-recharge-race-condition-poc/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 1229 PHPEMS Coupon Recharge Race Condition Poc" /&gt;&lt;h1 id=&#34;vulnerability-information&#34;&gt;Vulnerability Information
&lt;/h1&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Item&lt;/th&gt;
          &lt;th&gt;Details&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Vulnerability Name&lt;/td&gt;
          &lt;td&gt;PHPEMS Coupon Recharge Race Condition Vulnerability&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Affected Versions&lt;/td&gt;
          &lt;td&gt;PHPEMS 11.0 and earlier&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Type&lt;/td&gt;
          &lt;td&gt;Logic Flaw&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Severity&lt;/td&gt;
          &lt;td&gt;Medium&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;reproduction-environment&#34;&gt;Reproduction Environment
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;Test Site: Local deployment&lt;/li&gt;
&lt;li&gt;Source Code Setup: Download any version from the official website: &lt;a class=&#34;link&#34; href=&#34;https://www.phpems.net/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.phpems.net/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Tool: Burp Suite&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;reproduction-steps&#34;&gt;Reproduction Steps
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;Prepare data: Obtain a valid coupon code.
&lt;img src=&#34;https://byebydoggy.github.io/phpems/pic1.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/li&gt;
&lt;li&gt;Create multiple regular user accounts.&lt;/li&gt;
&lt;li&gt;Retrieve the cookie value for each account.&lt;/li&gt;
&lt;li&gt;Add the cookies to the script&amp;rsquo;s &lt;code&gt;cookies_list&lt;/code&gt;, replace &lt;code&gt;TARGET_COUPONSN&lt;/code&gt; with the valid coupon code, then execute the script.
&lt;img src=&#34;https://byebydoggy.github.io/phpems/pic2.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;
&lt;img src=&#34;https://byebydoggy.github.io/phpems/pic3.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;
&lt;img src=&#34;https://byebydoggy.github.io/phpems/pic4.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;
&lt;img src=&#34;https://byebydoggy.github.io/phpems/pic5.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Verification Result&lt;/strong&gt; : A single coupon can be used to recharge all accounts.Only one coupon redemption record is logged in the backend system.&lt;/p&gt;
&lt;h1 id=&#34;impact&#34;&gt;Impact
&lt;/h1&gt;&lt;p&gt;Attackers can maliciously accumulate virtual assets. If the coupons are tied to real currency, this vulnerability may lead to direct financial losses.&lt;/p&gt;
&lt;h1 id=&#34;mitigation-recommendations&#34;&gt;Mitigation Recommendations
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;Implement database row-level locking for coupon recharge operations.&lt;/li&gt;
&lt;li&gt;Add real-time validation of the coupon&amp;rsquo;s usage status.&lt;/li&gt;
&lt;li&gt;Restrict the frequency of recharge requests.&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        
    </channel>
</rss>
