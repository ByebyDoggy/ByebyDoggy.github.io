<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>区块链 on Byebyedoggy</title>
        <link>https://byebydoggy.github.io/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/</link>
        <description>Recent content in 区块链 on Byebyedoggy</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Fri, 19 Dec 2025 15:17:19 +0800</lastBuildDate><atom:link href="https://byebydoggy.github.io/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>1219 GoldFinch旧版本Pool合约漏洞</title>
        <link>https://byebydoggy.github.io/post/2025/1219-goldfinch%E6%97%A7%E7%89%88%E6%9C%ACpool%E5%90%88%E7%BA%A6%E6%BC%8F%E6%B4%9E/</link>
        <pubDate>Fri, 19 Dec 2025 15:17:19 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/1219-goldfinch%E6%97%A7%E7%89%88%E6%9C%ACpool%E5%90%88%E7%BA%A6%E6%BC%8F%E6%B4%9E/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 1219 GoldFinch旧版本Pool合约漏洞" /&gt;&lt;h1 id=&#34;相关信息&#34;&gt;相关信息
&lt;/h1&gt;&lt;p&gt;交易日志:&lt;/p&gt;
&lt;p&gt;0x3a8bde0a17e04f6a119ae2f28e6b56ac736feb70761e2fa97cac25f816f751c2&lt;/p&gt;
&lt;p&gt;代理合约&lt;/p&gt;
&lt;p&gt;0x0689aa2234d06Ac0d04cdac874331d287aFA4B43&lt;/p&gt;
&lt;p&gt;实际漏洞合约&lt;/p&gt;
&lt;p&gt;0x7dbE30FDE1Eca6856806fF14fc456ec6791c73FE&lt;/p&gt;
&lt;p&gt;Pool.sol&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-solidity&#34; data-lang=&#34;solidity&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// SPDX-License-Identifier: MIT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;pragma solidity&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;^&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;.&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;.&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;@openzeppelin/contracts-ethereum-package/contracts/access/Ownable.sol&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;@openzeppelin/contracts-ethereum-package/contracts/Initializable.sol&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;@openzeppelin/contracts-ethereum-package/contracts/math/SafeMath.sol&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;@openzeppelin/contracts-ethereum-package/contracts/token/ERC20/ERC20.sol&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./OwnerPausable.sol&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;contract&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Pool&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;is&lt;/span&gt; Initializable, OwnableUpgradeSafe, OwnerPausable {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;using&lt;/span&gt; SafeMath &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; sharePrice;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; mantissa;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; totalShares;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;mapping&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; capitalProviders;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; erc20address;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; totalFundsLimit &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; transactionLimit &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;DepositMade&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;indexed&lt;/span&gt; capitalProvider, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;WithdrawalMade&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;indexed&lt;/span&gt; capitalProvider, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;TransferMade&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;indexed&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;indexed&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;InterestCollected&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;indexed&lt;/span&gt; payer, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PrincipalCollected&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;indexed&lt;/span&gt; payer, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;LimitChanged&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;indexed&lt;/span&gt; owner, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; limitType, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;initialize&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; _erc20address, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; _name, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; _mantissa) &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; initializer {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    __Context_init_unchained();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    __Ownable_init_unchained();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    __OwnerPausable__init();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _name;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    erc20address &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _erc20address;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    mantissa &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _mantissa;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sharePrice &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _mantissa;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Sanity check the address
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    ERC20UpgradeSafe(erc20address).totalSupply();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Unlock self for infinite amount
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    ERC20UpgradeSafe(erc20address).approve(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;(this), &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;deposit&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;external&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;payable&lt;/span&gt; whenNotPaused {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    require(transactionWithinLimit(amount), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Amount is over the per-transaction limit.&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Determine current shares the address has, and the amount of new shares to be added
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; currentShares &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; capitalProviders[msg.sender];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; depositShares &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; getNumShares(amount, mantissa, sharePrice);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; potentialNewTotalShares &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; totalShares.add(depositShares);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    require(poolWithinLimit(potentialNewTotalShares), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Deposit would put the Pool over the total limit.&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    doERC20Transfer(msg.sender, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;(this), amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Add the new shares to both the pool and the address
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    totalShares &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; totalShares.add(depositShares);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    capitalProviders[msg.sender] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; currentShares.add(depositShares);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    emit DepositMade(msg.sender, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;withdraw&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;external&lt;/span&gt; whenNotPaused {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Determine current shares the address has and the shares requested to withdraw
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    require(transactionWithinLimit(amount), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Amount is over the per-transaction limit&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; currentShares &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; capitalProviders[msg.sender];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; withdrawShares &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; getNumShares(amount, mantissa, sharePrice);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Ensure the address has enough value in the pool
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    require(withdrawShares &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;=&lt;/span&gt; currentShares, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Amount requested is greater than what this address owns&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Remove the new shares from both the pool and the address
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    totalShares &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; totalShares.sub(withdrawShares);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    capitalProviders[msg.sender] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; currentShares.sub(withdrawShares);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Send the amount to the address
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    doERC20Transfer(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;(this), msg.sender, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    emit WithdrawalMade(msg.sender, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;collectInterestRepayment&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;external&lt;/span&gt; whenNotPaused {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    doERC20Transfer(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;(this), amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; increment &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; amount.mul(mantissa).div(totalShares);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sharePrice &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sharePrice &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; increment;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    emit InterestCollected(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;collectPrincipalRepayment&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;external&lt;/span&gt; whenNotPaused {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Purposefully does nothing except receive money. No share price updates for principal.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    doERC20Transfer(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;(this), amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    emit PrincipalCollected(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;setTotalFundsLimit&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; onlyOwner whenNotPaused {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    totalFundsLimit &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; amount;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    emit LimitChanged(msg.sender, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;totalFundsLimit&amp;#34;&lt;/span&gt;, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;setTransactionLimit&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; onlyOwner whenNotPaused {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    transactionLimit &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; amount;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    emit LimitChanged(msg.sender, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;transactionLimit&amp;#34;&lt;/span&gt;, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;transferFrom&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; onlyOwner whenNotPaused &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; result &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; doERC20Transfer(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, to, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    emit TransferMade(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, to, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; result;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;enoughBalance&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; user, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;view&lt;/span&gt; whenNotPaused &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ERC20UpgradeSafe(erc20address).balanceOf(user) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt; amount;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;/* Internal Functions */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poolWithinLimit&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; _totalShares) &lt;span style=&#34;color:#66d9ef&#34;&gt;internal&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;view&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; _totalShares.mul(sharePrice).div(mantissa) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;=&lt;/span&gt; totalFundsLimit;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;transactionWithinLimit&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;internal&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;view&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; amount &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;=&lt;/span&gt; transactionLimit;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getNumShares&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; multiplier, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; price) &lt;span style=&#34;color:#66d9ef&#34;&gt;internal&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;pure&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; amount.mul(multiplier).div(price);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;doERC20Transfer&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;internal&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ERC20UpgradeSafe erc20 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ERC20UpgradeSafe(erc20address);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; balanceBefore &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; erc20.balanceOf(to);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; success &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; erc20.transferFrom(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, to, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Calculate the amount that was *actually* transferred
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; balanceAfter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; erc20.balanceOf(to);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    require(balanceAfter &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;=&lt;/span&gt; balanceBefore, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Token Transfer Overflow Error&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; success;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;doERC20Withdraw&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;payable&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; amount) &lt;span style=&#34;color:#66d9ef&#34;&gt;internal&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ERC20UpgradeSafe erc20 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ERC20UpgradeSafe(erc20address);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; success &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; erc20.transfer(to, amount);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    require(success, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Token Withdraw Failed&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; success;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;漏洞原因&#34;&gt;漏洞原因
&lt;/h1&gt;&lt;p&gt;概括：调用collectInteresPayment时提高了sharePrice，紧接着立即提现时仅需消耗少量share即可提出实际价值更多的asset.  asset由全部授权给Pool合约的用户提供。 同时存在逻辑漏洞，允许任意调用偿还函数，导致了SharePrice操纵。 且大户无限授权了该合约，但未存入任何份额，导致成了提款机。&lt;/p&gt;
&lt;p&gt;漏洞还需要一个条件就是当前Pool合约的总份额极低，否则攻击者投入成本不足以覆盖收益。此处攻击投入成本10000U，获利350000.&lt;/p&gt;
</description>
        </item>
        <item>
        <title>1218 Abracadabra(MIM_SPELL) CauldronV4合约漏洞分析</title>
        <link>https://byebydoggy.github.io/post/2025/1218-abracadabramim_spell-cauldronv4%E5%90%88%E7%BA%A6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</link>
        <pubDate>Thu, 18 Dec 2025 18:22:21 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/1218-abracadabramim_spell-cauldronv4%E5%90%88%E7%BA%A6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 1218 Abracadabra(MIM_SPELL) CauldronV4合约漏洞分析" /&gt;&lt;h1 id=&#34;项目方&#34;&gt;项目方
&lt;/h1&gt;&lt;p&gt;x.com/MIM_Spell&lt;/p&gt;
&lt;h1 id=&#34;漏洞合约&#34;&gt;漏洞合约
&lt;/h1&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://dev.abracadabra.money/deployment-addresses/ethereum-mainnet&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://dev.abracadabra.money/deployment-addresses/ethereum-mainnet&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;其中Cauldrons V4的stdeusd合约具有漏洞&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-solidity&#34; data-lang=&#34;solidity&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;_additionalCookAction&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt; action, CookStatus &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; value, &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; data, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; value1, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; value2) &lt;span style=&#34;color:#66d9ef&#34;&gt;internal&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;virtual&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;bytes&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt;, CookStatus &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt;) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cook&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt;[] calldata actions,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;[] calldata values,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes&lt;/span&gt;[] calldata datas
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ) &lt;span style=&#34;color:#66d9ef&#34;&gt;external&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;payable&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;returns&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; value1, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; value2) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        CookStatus &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; status;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; actions.length; i&lt;span style=&#34;color:#f92672&#34;&gt;++&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt; action &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; actions[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;status.hasAccrued &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; action &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                accrue();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                status.hasAccrued &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_ADD_COLLATERAL) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; share, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; skim) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                addCollateral(to, skim, _num(share, value1, value2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_REPAY) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; part, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; skim) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                _repay(to, skim, _num(part, value1, value2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_REMOVE_COLLATERAL) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; share, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                _removeCollateral(to, _num(share, value1, value2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                status.needsSolvencyCheck &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BORROW) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; amount, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (value1, value2) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _borrow(to, _num(amount, value1, value2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                status.needsSolvencyCheck &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_UPDATE_EXCHANGE_RATE) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; must_update, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; minRate, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; maxRate) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; updated, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; rate) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; updateExchangeRate();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                require((&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;must_update &lt;span style=&#34;color:#f92672&#34;&gt;||&lt;/span&gt; updated) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; rate &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; minRate &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; (maxRate &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;||&lt;/span&gt; rate &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; maxRate), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Cauldron: rate not ok&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BENTO_SETAPPROVAL) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; user, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; _masterContract, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; approved, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt; v, &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes32&lt;/span&gt; r, &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes32&lt;/span&gt; s) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes32&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;bytes32&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                bentoBox.setMasterContractApproval(user, _masterContract, approved, v, r, s);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BENTO_DEPOSIT) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (value1, value2) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _bentoDeposit(datas[i], values[i], value1, value2);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BENTO_WITHDRAW) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (value1, value2) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _bentoWithdraw(datas[i], value1, value2);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BENTO_TRANSFER) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (IERC20 token, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; share) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (IERC20, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                bentoBox.transfer(token, msg.sender, to, _num(share, value1, value2));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_BENTO_TRANSFER_MULTIPLE) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (IERC20 token, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;[] &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; tos, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;[] &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; shares) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (IERC20, &lt;span style=&#34;color:#66d9ef&#34;&gt;address&lt;/span&gt;[], &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;[]));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                bentoBox.transferMultiple(token, msg.sender, tos, shares);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_CALL) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;bytes&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; returnData, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt; returnValues) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _call(values[i], datas[i], value1, value2);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (returnValues &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    (value1) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(returnData, (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (returnValues &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    (value1, value2) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(returnData, (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_GET_REPAY_SHARE) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; part &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                value1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; bentoBox.toShare(magicInternetMoney, totalBorrow.toElastic(_num(part, value1, value2), &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;), &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_GET_REPAY_PART) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt; amount &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(datas[i], (&lt;span style=&#34;color:#66d9ef&#34;&gt;int256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                value1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; totalBorrow.toBase(_num(amount, value1, value2), &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (action &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; ACTION_LIQUIDATE) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                _cookActionLiquidate(datas[i]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#66d9ef&#34;&gt;bytes&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; returnData, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint8&lt;/span&gt; returnValues, CookStatus &lt;span style=&#34;color:#66d9ef&#34;&gt;memory&lt;/span&gt; returnStatus) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _additionalCookAction(action, status, values[i], datas[i], value1, value2);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                status &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; returnStatus;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (returnValues &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    (value1) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(returnData, (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (returnValues &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    (value1, value2) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; abi.decode(returnData, (&lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (status.needsSolvencyCheck) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            (, &lt;span style=&#34;color:#66d9ef&#34;&gt;uint256&lt;/span&gt; _exchangeRate) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; updateExchangeRate();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            require(_isSolvent(msg.sender, _exchangeRate), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Cauldron: user insolvent&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;以上cook函数实现功能如下，输入一个actions列表，依次执行action，执行全部结束后检查调用者是否破产，若破产，reverte.&lt;/p&gt;
&lt;h1 id=&#34;问题&#34;&gt;问题
&lt;/h1&gt;&lt;p&gt;该版本Cauldron cook函数新增了else判断，使用了function_additionalCookAction以兼容后续更新,若调用者传入不存在的action时，走虚函数返回returnStatus为false，导致无需进行破产检查。因此可以输入actions=[Action.Borrow,任意不存在的action] 即可借出全部资产。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>某加密货币预测市场提现接口漏洞</title>
        <link>https://byebydoggy.github.io/post/2025/%E6%9F%90%E5%8A%A0%E5%AF%86%E8%B4%A7%E5%B8%81%E9%A2%84%E6%B5%8B%E5%B8%82%E5%9C%BA%E6%8F%90%E7%8E%B0%E6%8E%A5%E5%8F%A3%E6%BC%8F%E6%B4%9E/</link>
        <pubDate>Thu, 18 Dec 2025 18:20:44 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/%E6%9F%90%E5%8A%A0%E5%AF%86%E8%B4%A7%E5%B8%81%E9%A2%84%E6%B5%8B%E5%B8%82%E5%9C%BA%E6%8F%90%E7%8E%B0%E6%8E%A5%E5%8F%A3%E6%BC%8F%E6%B4%9E/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 某加密货币预测市场提现接口漏洞" /&gt;&lt;h1 id=&#34;思路&#34;&gt;思路
&lt;/h1&gt;&lt;p&gt;CVE-2025-55182发布后随机扫描区块链项目方，偶然发现这个小项目方。 进入服务器发现Next.js框架仅用于SSR渲染前端页面，没啥用处。获取到后端API地址以后，扫描后端端口及目录，发现swagger API，其中具有提现接口，然而调用时似乎缺少参数，于是分析前端打包后的代码，参数中包含提现目的地址和提现数量，简单试了下大数，小数，负数，科学计数法等等发现单次调用都会报错，所以应该是没有溢出问题，并发发起调用请求时可以多次提现，导致余额为负数。&lt;/p&gt;
&lt;p&gt;该漏洞本质还是Web漏洞，项目方修复速度很快，&lt;del&gt;点赞&lt;/del&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>2025 11 23 Port3 Hack</title>
        <link>https://byebydoggy.github.io/post/2025/2025-11-23-port3-hack/</link>
        <pubDate>Sun, 23 Nov 2025 13:56:21 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/2025-11-23-port3-hack/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 2025 11 23 Port3 Hack" /&gt;&lt;h1 id=&#34;evm-trackoor检测规则&#34;&gt;EVM-Trackoor检测规则
&lt;/h1&gt;&lt;p&gt;2025-11-23-04:56监控Mint地址0x000000&amp;hellip;.00转移10亿port3代币(3000W $)到黑客地址0xb13A503dA5f368E48577c87b5d5AeC73d08f812E&lt;/p&gt;
&lt;p&gt;hash:0x34c17a91b2f2ccd5973ecd49c20cc3c0939c5d8eaeeb740e9dec97fb1345e1da&lt;/p&gt;
&lt;h1 id=&#34;漏洞原理&#34;&gt;漏洞原理
&lt;/h1&gt;&lt;p&gt;Port3 bridgeIn正常调用时要求调用者存入代币和铸造的Port3代币价值相等，黑客利用可能缺失对铸造请求的签名校验、无重复请求拦截机制，或是未绑定合法铸造的权限地址白名单” 导致了0存入而大额铸造的漏洞。&lt;/p&gt;
&lt;h1 id=&#34;获利机会&#34;&gt;获利机会
&lt;/h1&gt;&lt;p&gt;4：56分监控到异常转移，5:05分黑客抛售，有10分钟做空空间，包含币安合约。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>ARKM前端逆向</title>
        <link>https://byebydoggy.github.io/post/2025/arkm%E5%89%8D%E7%AB%AF%E9%80%86%E5%90%91/</link>
        <pubDate>Tue, 18 Nov 2025 11:15:05 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/arkm%E5%89%8D%E7%AB%AF%E9%80%86%E5%90%91/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post ARKM前端逆向" /&gt;&lt;h1 id=&#34;arkm平台前端逆向&#34;&gt;ARKM平台前端逆向
&lt;/h1&gt;&lt;p&gt;1.随便找个包，发现headers中携带X-Payload参数，堆栈点一点，找到加密位置&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.imgur.la/images/2025/11/18/097f21372cda45b9b04bfe4364917d8b.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;097f21372cda45b9b04bfe4364917d8b&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;2.控制台打印获取a.ClientKey&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.imgur.la/images/2025/11/18/05785df35119761a009ecdcdac63c768.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;05785df35119761a009ecdcdac63c768&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;3.Python编写加密函数&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-python-repl&#34; data-lang=&#34;python-repl&#34;&gt;import requests
import time
import hashlib
import json
query = &amp;#34;bybit&amp;#34;
salt = &amp;#34;gh67j345kl&amp;#34;
def make_payload(path: str, ts: str) -&amp;gt; str:
    &amp;#34;&amp;#34;&amp;#34;复现 JS 里的两段 sha256 逻辑&amp;#34;&amp;#34;&amp;#34;
    step1 = hashlib.sha256(f&amp;#34;{path}:{ts}:{salt}&amp;#34;.encode()).hexdigest()
    return hashlib.sha256(f&amp;#34;{salt}:{step1}&amp;#34;.encode()).hexdigest()

path = &amp;#34;/transfers&amp;#34;
ts = str(int(time.time()))
payload = make_payload(path, ts)
# 1. 构造与浏览器一致的请求头
headers = {
    &amp;#34;accept&amp;#34;: &amp;#34;application/json, text/plain, */*&amp;#34;,
    &amp;#34;accept-encoding&amp;#34;: &amp;#34;gzip, deflate, br, zstd&amp;#34;,
    &amp;#34;accept-language&amp;#34;: &amp;#34;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&amp;#34;,
    &amp;#34;origin&amp;#34;: &amp;#34;https://intel.arkm.com&amp;#34;,
    &amp;#34;referer&amp;#34;: &amp;#34;https://intel.arkm.com/&amp;#34;,
    &amp;#34;sec-ch-ua&amp;#34;: &amp;#39;&amp;#34;Chromium&amp;#34;;v=&amp;#34;142&amp;#34;, &amp;#34;Microsoft Edge&amp;#34;;v=&amp;#34;142&amp;#34;, &amp;#34;Not_A Brand&amp;#34;;v=&amp;#34;99&amp;#34;&amp;#39;,
    &amp;#34;sec-ch-ua-mobile&amp;#34;: &amp;#34;?0&amp;#34;,
    &amp;#34;sec-ch-ua-platform&amp;#34;: &amp;#39;&amp;#34;Windows&amp;#34;&amp;#39;,
    &amp;#34;sec-fetch-dest&amp;#34;: &amp;#34;empty&amp;#34;,
    &amp;#34;sec-fetch-mode&amp;#34;: &amp;#34;cors&amp;#34;,
    &amp;#34;sec-fetch-site&amp;#34;: &amp;#34;same-site&amp;#34;,
    &amp;#34;user-agent&amp;#34;: &amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 &amp;#34;
                  &amp;#34;(KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0&amp;#34;,
    &amp;#34;x-timestamp&amp;#34;: ts,
    &amp;#34;x-payload&amp;#34;: payload,
        &amp;#34;cookie&amp;#34;: &amp;#34;_ga=GA1.1.1952893755.1763016182; _fbp=fb.1.1763016181936.907337779104231599; _clck=1erlme0%5E2%5Eg0z%5E0%5E2143; mp_db580d24fbe794a9a4765D&amp;#34;
}

# 3. 发起请求
url = f&amp;#34;https://api.arkm.com{path}&amp;#34;
resp = requests.get(url, headers=headers, timeout=10)
print(json.dumps(resp.json(), ensure_ascii=False, indent=2))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4.获取完整的项目方关联地址，参与到后续区块扫描流程&lt;/p&gt;
</description>
        </item>
        <item>
        <title>交易框架|MarketDataCollector</title>
        <link>https://byebydoggy.github.io/post/2025/%E4%BA%A4%E6%98%93%E6%A1%86%E6%9E%B6marketdatacollector/</link>
        <pubDate>Tue, 18 Nov 2025 01:40:11 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/%E4%BA%A4%E6%98%93%E6%A1%86%E6%9E%B6marketdatacollector/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 交易框架|MarketDataCollector" /&gt;&lt;h1 id=&#34;介绍&#34;&gt;介绍
&lt;/h1&gt;&lt;p&gt;使用coingecko及CMC定时采集主流交易所及链上项目合约地址，对于不同链不同交易所的相同币种使用coin_id作为唯一键进行定位，允许使用name,symbol,exchange,address进行索引。 用于整体交易流程中的代币查询流程。&lt;/p&gt;
&lt;h1 id=&#34;代办&#34;&gt;代办
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;优化查询操作&lt;/li&gt;
&lt;li&gt;优化存储结构，降低内存占用&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>交易框架 Hummingbot</title>
        <link>https://byebydoggy.github.io/post/2025/%E4%BA%A4%E6%98%93%E6%A1%86%E6%9E%B6hummingbot/</link>
        <pubDate>Tue, 18 Nov 2025 01:27:19 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/%E4%BA%A4%E6%98%93%E6%A1%86%E6%9E%B6hummingbot/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 交易框架 Hummingbot" /&gt;&lt;h1 id=&#34;部分优化&#34;&gt;部分优化
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;原项目在同一connector中添加多个symbol时，因Candles对象属于Clock对象，在生命周期每个tick每个Candles会向服务器发起health check，导致并发而被服务器限速，修改这部分问题。&lt;/li&gt;
&lt;li&gt;对于全部执行器均适配合约交易&lt;/li&gt;
&lt;li&gt;原项目完全基于tick进行策略触发，最短tick为1s，在ScriptStrategy基类基础上修改以支持事件驱动触发&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;待办&#34;&gt;待办
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;回测框架支持自定义策略，以及更短的时间框架（1s）&lt;/li&gt;
&lt;li&gt;支持从Tardis获取远期历史数据&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;附录&#34;&gt;附录
&lt;/h1&gt;&lt;p&gt;原项目地址: &lt;a class=&#34;link&#34; href=&#34;https://github.com/hummingbot/hummingbot&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>区块链扫描工具EVM-Trackooor</title>
        <link>https://byebydoggy.github.io/post/2025/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%B7%A5%E5%85%B7evm-trackooor/</link>
        <pubDate>Mon, 17 Nov 2025 22:31:54 +0800</pubDate>
        
        <guid>https://byebydoggy.github.io/post/2025/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%B7%A5%E5%85%B7evm-trackooor/</guid>
        <description>&lt;img src="https://byebydoggy.github.io/cover.png" alt="Featured image of post 区块链扫描工具EVM-Trackooor" /&gt;&lt;h1 id=&#34;原工具地址&#34;&gt;原工具地址
&lt;/h1&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/Zellic/EVM-trackooor&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github地址&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;部分优化&#34;&gt;部分优化
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;原工具依赖go-ethereum,目前仅支持1-3三种transaction type，ETH主网目前有第4种交易类型，非主网的交易类型更多。因此在events事件以及block刷新前过滤掉3种基本交易类型外的transaction，总体影响不大。&lt;/li&gt;
&lt;li&gt;原工具检测的攻击行为全部是外部交易，然而目前黑客攻击基本都隐藏在内部交易中，需要基于交易详细日志去检测。 新增基于监控地址内部转移价值不平衡，Genois Safe Proxy权限转移等异常特征。&lt;/li&gt;
&lt;li&gt;使用arkm威胁情报平台搜素主流项目的监控地址&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;问题&#34;&gt;问题
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;需本地部署节点以实时查询日志信息，若使用第三方RPC节点成本高于本地部署。&lt;/li&gt;
&lt;li&gt;ARKM需要申请API，目前申请难度较高，&lt;del&gt;计划前端逆向获取相关数据(待更新)&lt;/del&gt;&lt;/li&gt;
&lt;li&gt;使用前端逆向免费查询项目关联地址 &lt;a class=&#34;link&#34; href=&#34;https://byebydoggy.github.io/post/2025/ARKM%e5%89%8d%e7%ab%af%e9%80%86%e5%90%91&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github地址&lt;/a&gt;
~~&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        
    </channel>
</rss>
